import React from "react";

import Head from "next/head";

import { Canvas } from "@react-three/fiber";

import { Physics } from "@react-three/rapier";

import { KeyboardControls } from "@react-three/drei";

import { Perf } from "r3f-perf";

import styles from "@/styles/Home.module.scss";

import {
	Bloom,
	Noise,
	Glitch,
	ToneMapping,
	Vignette,
	EffectComposer,
} from "@react-three/postprocessing";

import Scene from "@/components/Scene";
import Light from "@/components/Light";
import Player from "@/components/Player";

export const getServerSideProps = async (context: any) => {
	return {
		props: {
			firstTimeVisit: true,
		},
	};
};

export default function Home() {
	return (
		<>
			<Head>
				<title>3D Portfolio</title>
				<meta name="description" content="Generated by create next app" />
				<meta name="viewport" content="width=device-width, initial-scale=1" />
				<link rel="icon" href="/favicon.ico" />
			</Head>
			<div className={styles.main}>
				<KeyboardControls
					map={[
						{ name: "forward", keys: ["ArrowUp", "KeyW"] },
						{ name: "backward", keys: ["ArrowDown", "KeyS"] },
						{ name: "leftward", keys: ["ArrowLeft", "KeyA"] },
						{ name: "rightward", keys: ["ArrowRight", "KeyD"] },
						{ name: "jump", keys: ["Space"] },
					]}
				>
					{/* @ts-ignore */}
					<Canvas
						shadows
						className={styles.canvas}
						camera={{
							fov: 45,
							near: 0.1,
							far: 200,
							position: [2.5, 4, 6],
						}}
					>
						{/* <color args={["#000000"]} attach="background" /> */}
						<Physics debug>
							<Perf position="top-left" />
							<Scene />
							<Light />
							<Player />

							<EffectComposer>
								<Bloom luminanceThreshold={1.1} mipmapBlur />
							</EffectComposer>
						</Physics>
					</Canvas>
				</KeyboardControls>
			</div>
		</>
	);
}
